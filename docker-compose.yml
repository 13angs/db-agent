# docker run --group-add 0 --group-add 1001 \
# -v /var/run/docker.sock:/var/run/docker.sock \ 
# -v /home/romdon/development/projects/13/db_agent/backup:/usr/src/app/backup \ 
# 13angs/db-agent:latest

version: '3'

services:
  agent:
    image: 13angs/db-agent:${IMG_VERSION}
    build:
      context: .
      dockerfile: Dockerfile

    environment:
      - JOB_NAME=${JOB_NAME}
      - DB_HOST=${DB_HOST}
      - DB_USER=${DB_USER}
      - DB_USER_PASSWORD=${DB_USER_PASSWORD}
      - DB_NAME=${DB_NAME}
      - BACKUP_PATH={BACKUP_PATH}
      - CONTAINER_NAME=${CONTAINER_NAME}

    # run a Docker image with additional groups for the user
    group_add:
      - '0' # root
      - '1001' # docker
    volumes:
      - ./backup:/usr/src/app/backup
      - ./restore:/usr/src/app/restore
      - /var/run/docker.sock:/var/run/docker.sock
